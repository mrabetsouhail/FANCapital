server:
  port: ${SERVER_PORT:8081}

app:
  cors:
    allowed-origins:
      - "http://127.0.0.1:*"
      - "http://localhost:*"

spring:
  datasource:
    url: "jdbc:h2:file:./data/fancapital;MODE=PostgreSQL;DB_CLOSE_ON_EXIT=FALSE"
    driverClassName: "org.h2.Driver"
    username: "sa"
    password: ""
  jpa:
    hibernate:
      ddl-auto: update
    properties:
      hibernate:
        format_sql: false
        jdbc:
          time_zone: UTC
  h2:
    console:
      enabled: true
      path: /h2-console

blockchain:
  rpc-url: "http://127.0.0.1:8545"
  # If not set, backend will try (in order):
  # ../blockchain/deployments/localhost.council-funds.json
  # ../blockchain/deployments/localhost.factory-funds.json
  deployments-path: ""
  # Private key used to sign LiquidityPool.buyFor/sellFor tx (must have OPERATOR_ROLE on each pool)
  operator-private-key: ${OPERATOR_PRIVATE_KEY:}
  # Panic Key (cold storage) for emergency global pause (PANIC_KEY_ROLE on CircuitBreaker).
  # This key should be stored offline and only used in emergency situations.
  # For production, this key MUST be stored in cold storage (hardware wallet, paper wallet, etc.).
  panic-private-key: ${PANIC_PRIVATE_KEY:}
  # Mint Key (HSM) for minting CashTokenTND (MINTER_ROLE on CashTokenTND).
  # In production, this key should be stored in a Hardware Security Module (HSM).
  mint-private-key: ${MINT_PRIVATE_KEY:}
  # Burn Key (HSM) for burning CashTokenTND (BURNER_ROLE on CashTokenTND).
  # In production, this key should be stored in a Hardware Security Module (HSM).
  burn-private-key: ${BURN_PRIVATE_KEY:}
  # Oracle Key (HSM) for updating VNI prices from BVMT (ORACLE_ROLE on PriceOracle).
  # According to Dossier de Sécurité v2.0, this key is dedicated exclusively to price updates.
  # In production, this key should be stored in a Hardware Security Module (HSM).
  oracle-private-key: ${ORACLE_PRIVATE_KEY:}
  # Onboarding Key (HSM) for KYC validation and account creation (KYC_VALIDATOR_ROLE on KYCRegistry).
  # According to Dossier de Sécurité v2.0, this key is used exclusively for KYC validation.
  # In production, this key should be stored in a Hardware Security Module (HSM).
  onboarding-private-key: ${ONBOARDING_PRIVATE_KEY:}
  # Dev helper: fixed prices to unblock UI testing (until oracle/API is wired)
  price-overrides:
    enabled: ${FIXED_VNI_ENABLED:true}
    atlas-tnd: ${FIXED_VNI_ATLAS_TND:10}
    didon-tnd: ${FIXED_VNI_DIDON_TND:5}
    spread-bps: ${FIXED_SPREAD_BPS:20}
    fee-bps: ${FIXED_FEE_BPS:100}
    vat-bps: ${FIXED_VAT_BPS:1900}

security:
  jwt:
    # OWASP: never hardcode secrets. Provide via environment variable.
    # Example (PowerShell):
    #   $env:JWT_SECRET="your-48+chars-secret"
    #   $env:JWT_TTL_SECONDS="86400"
    secret: ${JWT_SECRET:}
    ttl-seconds: ${JWT_TTL_SECONDS:86400}

wallet:
  # 32-byte base64 key for AES-GCM encryption of WaaS private keys (OWASP).
  # Example PowerShell:
  #   $bytes = New-Object byte[] 32; (New-Object System.Security.Cryptography.RNGCryptoServiceProvider).GetBytes($bytes); [Convert]::ToBase64String($bytes)
  #   $env:WALLET_ENC_KEY="<base64>"
  enc-key: ${WALLET_ENC_KEY:}

backoffice:
  tax:
    # Optional overrides (otherwise read from deployments json "infra")
    tax-vault-address: ${TAX_VAULT_ADDRESS:}
    cash-token-address: ${CASH_TOKEN_ADDRESS:}
    # Private key used to sign withdrawToFisc tx (must have GOVERNANCE_ROLE on TaxVault)
    governance-private-key: ${GOV_PRIVATE_KEY:}
    # Comma-separated list of emails allowed to use back-office actions
    admin-emails: ${ADMIN_EMAILS:}
  audit:
    # Regulator / auditor read-only access (comma-separated)
    regulator-emails: ${AUDIT_REGULATOR_EMAILS:}
    # Compliance officer access (exports + logs) (comma-separated)
    compliance-emails: ${AUDIT_COMPLIANCE_EMAILS:}
    reconciliation-enabled: ${AUDIT_RECON_ENABLED:false}
    reconciliation-interval-ms: ${AUDIT_RECON_INTERVAL_MS:300000}
    # Checkpoint generation every 10,000 blocks (Livre Blanc v2.1 - Section 4.1)
    checkpoint-enabled: ${AUDIT_CHECKPOINT_ENABLED:true}
    checkpoint-interval-ms: ${AUDIT_CHECKPOINT_INTERVAL_MS:600000}

